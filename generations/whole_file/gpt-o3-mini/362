import tkinter as tk
from tkinter import ttk
from tkinter import colorchooser
import random

def create_paint_canvas():
    root = tk.Tk()
    root.title("Painting Canvas")

    # Utwórz ramkę paska narzędzi
    toolbar = tk.Frame(root, bd=1, relief=tk.RAISED)
    toolbar.pack(side=tk.TOP, fill=tk.X)

    # Kontrola rozmiaru pędzla
    size_label = tk.Label(toolbar, text="Brush Size:")
    size_label.pack(side=tk.LEFT, padx=5)
    brush_size = tk.Scale(toolbar, from_=1, to=20, orient=tk.HORIZONTAL)
    brush_size.set(2)  # Domyślny rozmiar
    brush_size.pack(side=tk.LEFT, padx=5)

    # Aktualny wyświetlacz koloru i wybór koloru
    current_color = tk.StringVar(value="black")
    color_display = tk.Label(toolbar, bg=current_color.get(), width=3)
    color_display.pack(side=tk.LEFT, padx=5)

    def choose_color():
        color = colorchooser.askcolor(title="Choose brush color")[1]
        if color:  # Jeśli wybrano kolor (nie anulowano)
            current_color.set(color)
            color_display.config(bg=color)

    color_btn = tk.Button(toolbar, text="Choose Color", command=choose_color)
    color_btn.pack(side=tk.LEFT, padx=5)

    # Dodaj to po istniejącym przyciskiem wyboru koloru
    bg_color = tk.StringVar(value="white")  # Zapisz aktualny kolor tła
    bg_display = tk.Label(toolbar, bg=bg_color.get(), width=3)
    bg_display.pack(side=tk.LEFT, padx=5)

    def ereaser():
        current_color.set(bg_color.get())  # Ustaw kolor pędzla na kolor tła
        color_display.config(bg=bg_color.get())

    # przycisk gumki
    eraser_btn = tk.Button(toolbar, text="Eraser", command=ereaser)
    eraser_btn.pack(side=tk.LEFT, padx=5)

    def choose_background():
        color = colorchooser.askcolor(title="Choose background color")[1]
        if color:
            bg_color.set(color)
            bg_display.config(bg=color)
            canvas.config(bg=color)

    bg_btn = tk.Button(toolbar, text="Background Color", command=choose_background)
    bg_btn.pack(side=tk.LEFT, padx=5)

    # Dodaj przycisk, który zmienia tło na losowy kolor
    def random_background():
        # Generowanie losowego koloru w formacie szesnastkowym
        random_color = "#{:06x}".format(random.randint(0, 0xFFFFFF))
        bg_color.set(random_color)
        bg_display.config(bg=random_color)
        canvas.config(bg=random_color)

    random_bg_btn = tk.Button(toolbar, text="Random Background", command=random_background)
    random_bg_btn.pack(side=tk.LEFT, padx=5)

    # Utwórz płótno
    canvas = tk.Canvas(root, bg="white", width=800, height=600)
    canvas.pack(expand=tk.YES, fill=tk.BOTH)

    def clear_canvas():
        canvas.delete("all")  # Usuwa wszystkie rysunki z płótna

    # Przycisk czyszczenia płótna
    clear_btn = tk.Button(toolbar, text="Clear Canvas", command=clear_canvas)
    clear_btn.pack(side=tk.LEFT, padx=5)

    def paint(event):
        size = brush_size.get()  # Pobierz aktualny rozmiar pędzla
        x1, y1 = (event.x - size), (event.y - size)  # Oblicz lewy górny róg owalu
        x2, y2 = (event.x + size), (event.y + size)  # Oblicz dolny prawy róg owalu
        canvas.create_oval(x1, y1, x2, y2, fill=current_color.get(), outline=current_color.get())  # Narysuj owal na płótnie z aktualnym kolorem

    canvas.bind("<B1-Motion>", paint)

    root.mainloop()

if __name__ == "__main__":
    create_paint_canvas()